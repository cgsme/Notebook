# Kubernetes介绍

## Kubernetes是什么？

K8s是一个可移植的、可扩展的开源平台，用于管理容器化的工作负载和服务，可促进声明式配置和自动化。

Kubernetes 这个名字源于希腊语，意为“舵手”或“飞行员”。k8s 这个缩写是因为 k 和 s 之间有八个字符的关系。 Google 在 2014 年开源了 Kubernetes 项目。Kubernetes 建立在 Google 在大规模运行生产工作负载方面拥有十几年的经验 的基础上，结合了社区中最好的想法和实践。

部署方式的演进：

![部署方式的演进](https://d33wubrfki0l68.cloudfront.net/26a177ede4d7b032362289c6fccd448fc4a91174/eb693/images/docs/container_evolution.svg '程序部署方式演进')

- 传统部署时代

各公司和组织都在物理服务器上运行应用程序。无法为物理服务器中的应用程序定义资源边界，会导致资源分配问题。

- 虚拟化部署时代

作为传统部署方式的解决方案，引入了虚拟化。虚拟化技术允许我们在单个物理服务器的CPU上运行多个虚拟机（VM）。虚拟化允许应用程序在VM之间隔离，并提供一定程度的安全，因为一个应用程序的信息不能被另一个应用程序随意访问。

虚拟化技术能够更好地利用物理服务器上的资源，并且因为可以轻松地添加或更新应用程序而可以实现更好的伸缩性，降低硬件成本。

- 容器部署时代

容器类似与VM，但是它们具有被放宽的隔离属性，**可以在应用程序之间共享操作系统**（OS）。因此，容器被认为是轻量级的。与VM类似，具有自己的文件系统、CPU、内存、进程空间等。由于它们与基础架构分离，因此可以跨云和OS发行版进行移植。

容器因具有许多优势而变得流行起来：

- 敏捷应用程序的创建和部署：与使用VM相比，提高了容器镜像创建的简便性和效率。
- 持续开发、集成和部署：通过快速简单的回滚（由于镜像不可变性），支持可靠且频繁地构建和部署容器镜像。
- 关注开发与运维的分离：在构建和发布时创建应用程序镜像，而不是在部署时创建。从而将应用程序和基础架构分离。
- 可观察性：不仅可以显示操作系统级别的信息和指标，还可以显示应用程序的运行状况和其他指标信号。
- 跨开发、测试和生产的环境一致性：在便携计算机上与云中相同地运行。
- 跨云和操作系统发行版本的可移植性：可在Ubuntu。RHEL、CoreOS、本地、Google Kubernetes Engine 和其他任何地方运行。
- 以应用程序为中心的管理：提高抽象级别，从在虚拟硬件上运行 OS 到使用逻辑资源在 OS 上运行应用程序。
- 松散耦合、分布式、弹性、解放的微服务：应用程序被分解成较小的独立部分， 并且可以动态部署和管理 - 而不是在一台大型单机上整体运行。
- 资源隔离：可预测的应用程序性能。
- 资源利用：高效率和高密度。

## 为什么需要Kubernetes

容器是打包和运行应用程序的好方式。在生产环境中，你需要管理运行应用程序的容器，并确保不会停机。如果一个容器发生故障，则需要启动另一个容器。如果有专门的系统处理这样的行为，就容易多了。

而K8s就是用来解决这些问题的系统。K8s提供了一个可弹性运行分布式系统的框架。K8s提供：

- 服务发现可负载均衡

K8s可以使用DNS名称或自己的IP地址公开器，如果进入容器的流量很大，K8s可以负载均衡并分配网络流量，从而使部署稳定。

- 存储编排

K8s允许你自动挂载你选择的存储系统，例如：本地存储、共有云提供商等。

- 自动部署和回滚

可以使用K8s描述已经部署的容器的所需状态，它可以以受控的速率将实际状态更改为期望状态。例如，可以自动化k8来部署创建新的容器，删除现有容器并将它们的所有资源用于新的容器。

- 自动完成装箱计算

k8s允许为每个容器指定所需CPU和内存（RAM）。当容器指定了资源请求时，k8s可以做出更好的决策来管理容器的资源。

- 自我修复

k8s重新启动失败的容器、日换容器、杀死不响应用户定义的运行状况检查的容器，并且在准备好服务器之前不将器通告给其他客户端。

- 密钥与配置管理

k8s允许存储和管理敏感信息，例如密码、OAuth令牌和ssh密钥。可以在不重建容器镜像的情况下部署和更新密钥和应用程序配置，也无需在堆栈配置中暴露密钥。

## Kubernetes不是什么

Kubernetes 不是传统的、包罗万象的 PaaS（平台即服务）系统。 由于 Kubernetes 在容器级别而不是在硬件级别运行，它提供了 PaaS 产品共有的一些普遍适用的功能， 例如部署、扩展、负载均衡、日志记录和监视。 但是，Kubernetes 不是单体系统，默认解决方案都是可选和可插拔的。 Kubernetes 提供了构建开发人员平台的基础，但是在重要的地方保留了用户的选择和灵活性。

- 不限制支持的应用程序类型。 Kubernetes旨在支持极其多种多样的工作负载，包括无状态、有状态和数据处理工作负载。如果应用程序可以在容器中运行，那么它应该可以在Kubernetes上很好地运行。
- 不部署源代码，也不构建你的应用程序。持续集成(CI)、交付和部署（CI/CD）工作流取决于组织的文化和偏好以及技术要求。
- 不提供应用程序级别的服务作为内置服务，例如中间件（例如，消息中间件）、数据处理框架（例如，Spark）、数据库（例如，mysql）、缓存、集群存储系统（例如，Ceph）。这样的组件可以在Kubernetes上运行，并且/或者可以由运行在Kubernetes上的应用程序通过可移植机制（例如，开放服务代理）来访问。
- 不要求日志记录、监视或警报解决方案。它提供了一些集成作为概念证明，并提供了收集和导出指标的机制。
- 不提供或不要求配置语言/系统（例如 jsonnet），它提供了声明性API，该声明性API可以由任意形式的声明性规范所构成。
- 不提供也不采用任何全面的机器配置、维护、管理或自我修复系统。
- 此外，Kubernetes不仅仅是一个编排系统，实际上它消除了编排的需要。编排的技术定义是执行已定义的工作流程：首先执行A，然后执行B，再执行C。相比之下，Kubernetes包含一组独立的、可组合的控制过程，这些过程连续地将当前状态驱动到所提供的所需状态。如何从A到C的方式无关紧要，也不需要集中控制，这使得系统更易于使用 且功能更强大、系统更健壮、更为弹性和可扩展。
